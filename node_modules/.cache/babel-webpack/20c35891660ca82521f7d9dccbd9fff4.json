{"ast":null,"code":"// Copyright (c) Microsoft, Inc. All rights reserved. See License.txt in the project root for license information.\n;\n(function (factory) {\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  function checkGlobal(value) {\n    return value && value.Object === Object ? value : null;\n  }\n\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType ? exports : null;\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType ? module : null;\n  var freeGlobal = checkGlobal(freeExports && freeModule && typeof global === 'object' && global);\n  var freeSelf = checkGlobal(objectTypes[typeof self] && self);\n  var freeWindow = checkGlobal(objectTypes[typeof window] && window);\n  var moduleExports = freeModule && freeModule.exports === freeExports ? freeExports : null;\n  var thisGlobal = checkGlobal(objectTypes[typeof this] && this);\n  var root = freeGlobal || freeWindow !== (thisGlobal && thisGlobal.window) && freeWindow || freeSelf || thisGlobal || Function('return this')(); // Because of build optimizers\n\n  if (typeof define === 'function' && define.amd) {\n    define(['rx'], function (Rx, exports) {\n      return factory(root, exports, Rx);\n    });\n  } else if (typeof module === 'object' && module && module.exports === freeExports) {\n    module.exports = factory(root, module.exports, require('rx'));\n  } else {\n    root.Rx = factory(root, {}, root.Rx);\n  }\n}).call(this, function (root, exp, Rx, undefined) {\n  var Observable = Rx.Observable,\n      ObservableBase = Rx.ObservableBase,\n      AbstractObserver = Rx.internals.AbstractObserver,\n      observerCreate = Rx.Observer.create,\n      observableCreate = Rx.Observable.create,\n      disposableCreate = Rx.Disposable.create,\n      Disposable = Rx.Disposable,\n      CompositeDisposable = Rx.CompositeDisposable,\n      BinaryDisposable = Rx.BinaryDisposable,\n      SingleAssignmentDisposable = Rx.SingleAssignmentDisposable,\n      Subject = Rx.Subject,\n      Scheduler = Rx.Scheduler,\n      dom = Rx.DOM = {},\n      hasOwnProperty = {}.hasOwnProperty,\n      noop = Rx.helpers.noop,\n      isFunction = Rx.helpers.isFunction,\n      inherits = Rx.internals.inherits;\n  var errorObj = {\n    e: {}\n  };\n\n  function tryCatcherGen(tryCatchTarget) {\n    return function tryCatcher() {\n      try {\n        return tryCatchTarget.apply(this, arguments);\n      } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n      }\n    };\n  }\n\n  function tryCatch(fn) {\n    if (!isFunction(fn)) {\n      throw new TypeError('fn must be a function');\n    }\n\n    return tryCatcherGen(fn);\n  }\n\n  function thrower(e) {\n    throw e;\n  }\n\n  function socketClose(socket, closingObserver, code, reason) {\n    if (socket) {\n      if (closingObserver) {\n        closingObserver.onNext();\n        closingObserver.onCompleted();\n      }\n\n      if (!code) {\n        socket.close();\n      } else {\n        socket.close(code, reason);\n      }\n    }\n  }\n\n  var SocketObservable = function (__super__) {\n    inherits(SocketObservable, __super__);\n\n    function SocketObservable(state, url, protocol, open, close) {\n      this._state = state;\n      this._url = url;\n      this._protocol = protocol;\n      this._open = open;\n      this._close = close;\n\n      __super__.call(this);\n    }\n\n    function createOpenHandler(open, socket) {\n      return function openHandler(e) {\n        open.onNext(e);\n        open.onCompleted();\n        socket.removeEventListener('open', openHandler, false);\n      };\n    }\n\n    function createMsgHandler(o) {\n      return function msgHandler(e) {\n        o.onNext(e);\n      };\n    }\n\n    function createErrHandler(o) {\n      return function errHandler(e) {\n        o.onError(e);\n      };\n    }\n\n    function createCloseHandler(o) {\n      return function closeHandler(e) {\n        if (e.code !== 1000 || !e.wasClean) {\n          return o.onError(e);\n        }\n\n        o.onCompleted();\n      };\n    }\n\n    function SocketDisposable(socket, msgFn, errFn, closeFn, close) {\n      this._socket = socket;\n      this._msgFn = msgFn;\n      this._errFn = errFn;\n      this._closeFn = closeFn;\n      this._close = close;\n      this.isDisposed = false;\n    }\n\n    SocketDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        socketClose(this._socket, this._close);\n\n        this._socket.removeEventListener('message', this._msgFn, false);\n\n        this._socket.removeEventListener('error', this._errFn, false);\n\n        this._socket.removeEventListener('close', this._closeFn, false);\n      }\n    };\n\n    SocketObservable.prototype.subscribeCore = function (o) {\n      this._state.socket = this._protocol ? new WebSocket(this._url, this._protocol) : new WebSocket(this._url);\n      var openHandler = createOpenHandler(this._open, this._state.socket);\n      var msgHandler = createMsgHandler(o);\n      var errHandler = createErrHandler(o);\n      var closeHandler = createCloseHandler(o);\n      this._open && this._state.socket.addEventListener('open', openHandler, false);\n\n      this._state.socket.addEventListener('message', msgHandler, false);\n\n      this._state.socket.addEventListener('error', errHandler, false);\n\n      this._state.socket.addEventListener('close', closeHandler, false);\n\n      return new SocketDisposable(this._state.socket, msgHandler, errHandler, closeHandler, this._close);\n    };\n\n    return SocketObservable;\n  }(ObservableBase);\n\n  var SocketObserver = function (__super__) {\n    inherits(SocketObserver, __super__);\n\n    function SocketObserver(state, close) {\n      this._state = state;\n      this._close = close;\n\n      __super__.call(this);\n    }\n\n    SocketObserver.prototype.next = function (x) {\n      this._state.socket && this._state.socket.readyState === WebSocket.OPEN && this._state.socket.send(x);\n    };\n\n    SocketObserver.prototype.error = function (e) {\n      if (!e.code) {\n        throw new Error('no code specified. be sure to pass { code: ###, reason: \"\" } to onError()');\n      }\n\n      socketClose(this._state.socket, this._close, e.code, e.reason || '');\n    };\n\n    SocketObserver.prototype.completed = function () {\n      socketClose(this._state.socket, this._close, 1000, '');\n    };\n\n    return SocketObserver;\n  }(AbstractObserver);\n  /**\n  * Creates a WebSocket Subject with a given URL, protocol and an optional observer for the open event.\n  *\n  * @example\n  *  var socket = Rx.DOM.fromWebSocket('http://localhost:8080', 'stock-protocol', openObserver, closingObserver);\n  *\n  * @param {String} url The URL of the WebSocket.\n  * @param {String} protocol The protocol of the WebSocket.\n  * @param {Observer} [openObserver] An optional Observer to capture the open event.\n  * @param {Observer} [closingObserver] An optional Observer to capture the moment before the underlying socket is closed.\n  * @returns {Subject} An observable sequence wrapping a WebSocket.\n  */\n\n\n  dom.fromWebSocket = function (url, protocol, openObserver, closingObserver) {\n    if (!WebSocket) {\n      throw new TypeError('WebSocket not implemented in your runtime.');\n    }\n\n    var state = {\n      socket: null\n    };\n    return Subject.create(new SocketObserver(state, closingObserver), new SocketObservable(state, url, protocol, openObserver, closingObserver));\n  };\n\n  var WorkerObserver = function (__super__) {\n    inherits(WorkerObserver, __super__);\n\n    function WorkerObserver(state) {\n      this._state = state;\n\n      __super__.call(this);\n    }\n\n    WorkerObserver.prototype.next = function (x) {\n      this._state.worker && this._state.worker.postMessage(x);\n    };\n\n    WorkerObserver.prototype.error = function (e) {\n      throw e;\n    };\n\n    WorkerObserver.prototype.completed = function () {};\n\n    return WorkerObserver;\n  }(AbstractObserver);\n\n  var WorkerObservable = function (__super__) {\n    inherits(WorkerObservable, __super__);\n\n    function WorkerObservable(state, url) {\n      this._state = state;\n      this._url = url;\n\n      __super__.call(this);\n    }\n\n    function createMessageHandler(o) {\n      return function messageHandler(e) {\n        o.onNext(e);\n      };\n    }\n\n    function createErrHandler(o) {\n      return function errHandler(e) {\n        o.onError(e);\n      };\n    }\n\n    function WorkerDisposable(w, msgFn, errFn) {\n      this._w = w;\n      this._msgFn = msgFn;\n      this._errFn = errFn;\n      this.isDisposed = false;\n    }\n\n    WorkerDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n\n        this._w.terminate();\n\n        this._w.removeEventListener('message', this._msgFn, false);\n\n        this._w.removeEventListener('error', this._errFn, false);\n      }\n    };\n\n    WorkerObservable.prototype.subscribeCore = function (o) {\n      this._state.worker = new root.Worker(this._url);\n      var messageHandler = createMessageHandler(o);\n      var errHandler = createErrHandler(o);\n\n      this._state.worker.addEventListener('message', messageHandler, false);\n\n      this._state.worker.addEventListener('error', errHandler, false);\n\n      return new WorkerDisposable(this._state.worker, messageHandler, errHandler);\n    };\n\n    return WorkerObservable;\n  }(ObservableBase);\n  /**\n   * Creates a Web Worker with a given URL as a Subject.\n   *\n   * @example\n   * var worker = Rx.DOM.fromWebWorker('worker.js');\n   *\n   * @param {String} url The URL of the Web Worker.\n   * @returns {Subject} A Subject wrapping the Web Worker.\n   */\n\n\n  dom.fromWorker = function (url) {\n    if (!root.Worker) {\n      throw new TypeError('Worker not implemented in your runtime.');\n    }\n\n    var state = {\n      worker: null\n    };\n    return Subject.create(new WorkerObserver(state), new WorkerObservable(state, url));\n  };\n\n  function getMutationObserver(next) {\n    var M = root.MutationObserver || root.WebKitMutationObserver;\n    return new M(next);\n  }\n\n  var MutationObserverObservable = function (__super__) {\n    inherits(MutationObserverObservable, __super__);\n\n    function MutationObserverObservable(target, options) {\n      this._target = target;\n      this._options = options;\n\n      __super__.call(this);\n    }\n\n    function InnerDisposable(mutationObserver) {\n      this._m = mutationObserver;\n      this.isDisposed = false;\n    }\n\n    InnerDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n\n        this._m.disconnect();\n      }\n    };\n\n    MutationObserverObservable.prototype.subscribeCore = function (o) {\n      var mutationObserver = getMutationObserver(function (e) {\n        o.onNext(e);\n      });\n      mutationObserver.observe(this._target, this._options);\n      return new InnerDisposable(mutationObserver);\n    };\n\n    return MutationObserverObservable;\n  }(ObservableBase);\n  /**\n   * Creates an observable sequence from a Mutation Observer.\n   * MutationObserver provides developers a way to react to changes in a DOM.\n   * @example\n   *  Rx.DOM.fromMutationObserver(document.getElementById('foo'), { attributes: true, childList: true, characterData: true });\n   *\n   * @param {Object} target The Node on which to obserave DOM mutations.\n   * @param {Object} options A MutationObserverInit object, specifies which DOM mutations should be reported.\n   * @returns {Observable} An observable sequence which contains mutations on the given DOM target.\n   */\n\n\n  dom.fromMutationObserver = function (target, options) {\n    if (!(root.MutationObserver || root.WebKitMutationObserver)) {\n      throw new TypeError('MutationObserver not implemented in your runtime.');\n    }\n\n    return new MutationObserverObservable(target, options);\n  };\n\n  var CurrentPositionObservable = function (__super__) {\n    inherits(CurrentPositionObservable, __super__);\n\n    function CurrentPositionObservable(opts) {\n      this._opts = opts;\n\n      __super__.call(this);\n    }\n\n    CurrentPositionObservable.prototype.subscribeCore = function (o) {\n      root.navigator.geolocation.getCurrentPosition(function (data) {\n        o.onNext(data);\n        o.onCompleted();\n      }, function (e) {\n        o.onError(e);\n      }, this._opts);\n    };\n\n    return CurrentPositionObservable;\n  }(ObservableBase);\n\n  var WatchPositionObservable = function (__super__) {\n    inherits(WatchPositionObservable, __super__);\n\n    function WatchPositionObservable(opts) {\n      this._opts = opts;\n\n      __super__.call(this);\n    }\n\n    function WatchPositionDisposable(id) {\n      this._id = id;\n      this.isDisposed = false;\n    }\n\n    WatchPositionDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        root.navigator.geolocation.clearWatch(this._id);\n      }\n    };\n\n    WatchPositionObservable.prototype.subscribeCore = function (o) {\n      var watchId = root.navigator.geolocation.watchPosition(function (x) {\n        o.onNext(x);\n      }, function (e) {\n        o.onError(e);\n      }, this._opts);\n      return new WatchPositionDisposable(watchId);\n    };\n\n    return WatchPositionObservable;\n  }(ObservableBase);\n\n  Rx.DOM.geolocation = {\n    /**\n    * Obtains the geographic position, in terms of latitude and longitude coordinates, of the device.\n    * @param {Object} [geolocationOptions] An object literal to specify one or more of the following attributes and desired values:\n    *   - enableHighAccuracy: Specify true to obtain the most accurate position possible, or false to optimize in favor of performance and power consumption.\n    *   - timeout: An Integer value that indicates the time, in milliseconds, allowed for obtaining the position.\n    *              If timeout is Infinity, (the default value) the location request will not time out.\n    *              If timeout is zero (0) or negative, the results depend on the behavior of the location provider.\n    *   - maximumAge: An Integer value indicating the maximum age, in milliseconds, of cached position information.\n    *                 If maximumAge is non-zero, and a cached position that is no older than maximumAge is available, the cached position is used instead of obtaining an updated location.\n    *                 If maximumAge is zero (0), watchPosition always tries to obtain an updated position, even if a cached position is already available.\n    *                 If maximumAge is Infinity, any cached position is used, regardless of its age, and watchPosition only tries to obtain an updated position if no cached position data exists.\n    * @returns {Observable} An observable sequence with the geographical location of the device running the client.\n    */\n    getCurrentPosition: function (geolocationOptions) {\n      if (!root.navigator && !root.navigation.geolocation) {\n        throw new TypeError('geolocation not available');\n      }\n\n      return new CurrentPositionObservable(geolocationOptions);\n    },\n\n    /**\n    * Begins listening for updates to the current geographical location of the device running the client.\n    * @param {Object} [geolocationOptions] An object literal to specify one or more of the following attributes and desired values:\n    *   - enableHighAccuracy: Specify true to obtain the most accurate position possible, or false to optimize in favor of performance and power consumption.\n    *   - timeout: An Integer value that indicates the time, in milliseconds, allowed for obtaining the position.\n    *              If timeout is Infinity, (the default value) the location request will not time out.\n    *              If timeout is zero (0) or negative, the results depend on the behavior of the location provider.\n    *   - maximumAge: An Integer value indicating the maximum age, in milliseconds, of cached position information.\n    *                 If maximumAge is non-zero, and a cached position that is no older than maximumAge is available, the cached position is used instead of obtaining an updated location.\n    *                 If maximumAge is zero (0), watchPosition always tries to obtain an updated position, even if a cached position is already available.\n    *                 If maximumAge is Infinity, any cached position is used, regardless of its age, and watchPosition only tries to obtain an updated position if no cached position data exists.\n    * @returns {Observable} An observable sequence with the current geographical location of the device running the client.\n    */\n    watchPosition: function (geolocationOptions) {\n      if (!root.navigator && !root.navigation.geolocation) {\n        throw new TypeError('geolocation not available');\n      }\n\n      return new WatchPositionObservable(geolocationOptions).publish().refCount();\n    }\n  };\n\n  var FromReaderObservable = function (__super__) {\n    inherits(FromReaderObservable, __super__);\n\n    function FromReaderObservable(readerFn, file, progressObserver, encoding) {\n      this._readerFn = readerFn;\n      this._file = file;\n      this._progressObserver = progressObserver;\n      this._encoding = encoding;\n\n      __super__.call(this);\n    }\n\n    function createLoadHandler(o, p) {\n      return function loadHandler(e) {\n        p && p.onCompleted();\n        o.onNext(e.target.result);\n        o.onCompleted();\n      };\n    }\n\n    function createErrorHandler(o) {\n      return function errorHandler(e) {\n        o.onError(e.target.error);\n      };\n    }\n\n    function createProgressHandler(o) {\n      return function progressHandler(e) {\n        o.onNext(e);\n      };\n    }\n\n    function FromReaderDisposable(reader, progressObserver, loadHandler, errorHandler, progressHandler) {\n      this._r = reader;\n      this._po = progressObserver;\n      this._lFn = loadHandler;\n      this._eFn = errorHandler;\n      this._pFn = progressHandler;\n      this.isDisposed = false;\n    }\n\n    FromReaderDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        this._r.readyState === root.FileReader.LOADING && this._r.abort();\n\n        this._r.removeEventListener('load', this._lFn, false);\n\n        this._r.removeEventListener('error', this._eFn, false);\n\n        this._po && this._r.removeEventListener('progress', this._pFn, false);\n      }\n    };\n\n    FromReaderObservable.prototype.subscribeCore = function (o) {\n      var reader = new root.FileReader();\n      var loadHandler = createLoadHandler(o, this._progressObserver);\n      var errorHandler = createErrorHandler(o);\n      var progressHandler = createProgressHandler(this._progressObserver);\n      reader.addEventListener('load', loadHandler, false);\n      reader.addEventListener('error', errorHandler, false);\n      this._progressObserver && reader.addEventListener('progress', progressHandler, false);\n\n      reader[this._readerFn](this._file, this._encoding);\n\n      return new FromReaderDisposable(reader, this._progressObserver, loadHandler, errorHandler, progressHandler);\n    };\n\n    return FromReaderObservable;\n  }(ObservableBase);\n  /**\n   * The FileReader object lets web applications asynchronously read the contents of\n   * files (or raw data buffers) stored on the user's computer, using File or Blob objects\n   * to specify the file or data to read as an observable sequence.\n   * @param {String} file The file to read.\n   * @param {Observer} An observer to watch for progress.\n   * @returns {Object} An object which contains methods for reading the data.\n   */\n\n\n  dom.fromReader = function (file, progressObserver) {\n    if (!root.FileReader) {\n      throw new TypeError('FileReader not implemented in your runtime.');\n    }\n\n    return {\n      /**\n       * This method is used to read the file as an ArrayBuffer as an Observable stream.\n       * @returns {Observable} An observable stream of an ArrayBuffer\n       */\n      asArrayBuffer: function () {\n        return new FromReaderObservable('readAsArrayBuffer', file, progressObserver);\n      },\n\n      /**\n       * This method is used to read the file as a binary data string as an Observable stream.\n       * @returns {Observable} An observable stream of a binary data string.\n       */\n      asBinaryString: function () {\n        return new FromReaderObservable('readAsBinaryString', file, progressObserver);\n      },\n\n      /**\n       * This method is used to read the file as a URL of the file's data as an Observable stream.\n       * @returns {Observable} An observable stream of a URL representing the file's data.\n       */\n      asDataURL: function () {\n        return new FromReaderObservable('readAsDataURL', file, progressObserver);\n      },\n\n      /**\n       * This method is used to read the file as a string as an Observable stream.\n       * @returns {Observable} An observable stream of the string contents of the file.\n       */\n      asText: function (encoding) {\n        return new FromReaderObservable('readAsText', file, progressObserver, encoding);\n      }\n    };\n  };\n\n  return Rx;\n});","map":{"version":3,"sources":["D:/Noveno Ciclo/IA/ProyectoFinal/angular-unity/node_modules/rx-dom-html/rx.dom.html.js"],"names":["factory","objectTypes","checkGlobal","value","Object","freeExports","exports","nodeType","freeModule","module","freeGlobal","global","freeSelf","self","freeWindow","window","moduleExports","thisGlobal","root","Function","define","amd","Rx","require","call","exp","undefined","Observable","ObservableBase","AbstractObserver","internals","observerCreate","Observer","create","observableCreate","disposableCreate","Disposable","CompositeDisposable","BinaryDisposable","SingleAssignmentDisposable","Subject","Scheduler","dom","DOM","hasOwnProperty","noop","helpers","isFunction","inherits","errorObj","e","tryCatcherGen","tryCatchTarget","tryCatcher","apply","arguments","tryCatch","fn","TypeError","thrower","socketClose","socket","closingObserver","code","reason","onNext","onCompleted","close","SocketObservable","__super__","state","url","protocol","open","_state","_url","_protocol","_open","_close","createOpenHandler","openHandler","removeEventListener","createMsgHandler","o","msgHandler","createErrHandler","errHandler","onError","createCloseHandler","closeHandler","wasClean","SocketDisposable","msgFn","errFn","closeFn","_socket","_msgFn","_errFn","_closeFn","isDisposed","prototype","dispose","subscribeCore","WebSocket","addEventListener","SocketObserver","next","x","readyState","OPEN","send","error","Error","completed","fromWebSocket","openObserver","WorkerObserver","worker","postMessage","WorkerObservable","createMessageHandler","messageHandler","WorkerDisposable","w","_w","terminate","Worker","fromWorker","getMutationObserver","M","MutationObserver","WebKitMutationObserver","MutationObserverObservable","target","options","_target","_options","InnerDisposable","mutationObserver","_m","disconnect","observe","fromMutationObserver","CurrentPositionObservable","opts","_opts","navigator","geolocation","getCurrentPosition","data","WatchPositionObservable","WatchPositionDisposable","id","_id","clearWatch","watchId","watchPosition","geolocationOptions","navigation","publish","refCount","FromReaderObservable","readerFn","file","progressObserver","encoding","_readerFn","_file","_progressObserver","_encoding","createLoadHandler","p","loadHandler","result","createErrorHandler","errorHandler","createProgressHandler","progressHandler","FromReaderDisposable","reader","_r","_po","_lFn","_eFn","_pFn","FileReader","LOADING","abort","fromReader","asArrayBuffer","asBinaryString","asDataURL","asText"],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft, Inc. All rights reserved. See License.txt in the project root for license information.\n\n;(function (factory) {\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  function checkGlobal(value) {\n    return (value && value.Object === Object) ? value : null;\n  }\n\n  var freeExports = (objectTypes[typeof exports] && exports && !exports.nodeType) ? exports : null;\n  var freeModule = (objectTypes[typeof module] && module && !module.nodeType) ? module : null;\n  var freeGlobal = checkGlobal(freeExports && freeModule && typeof global === 'object' && global);\n  var freeSelf = checkGlobal(objectTypes[typeof self] && self);\n  var freeWindow = checkGlobal(objectTypes[typeof window] && window);\n  var moduleExports = (freeModule && freeModule.exports === freeExports) ? freeExports : null;\n  var thisGlobal = checkGlobal(objectTypes[typeof this] && this);\n  var root = freeGlobal || ((freeWindow !== (thisGlobal && thisGlobal.window)) && freeWindow) || freeSelf || thisGlobal || Function('return this')();\n\n  // Because of build optimizers\n  if (typeof define === 'function' && define.amd) {\n    define(['rx'], function (Rx, exports) {\n      return factory(root, exports, Rx);\n    });\n  } else if (typeof module === 'object' && module && module.exports === freeExports) {\n    module.exports = factory(root, module.exports, require('rx'));\n  } else {\n    root.Rx = factory(root, {}, root.Rx);\n  }\n}.call(this, function (root, exp, Rx, undefined) {\n\n  var Observable = Rx.Observable,\n    ObservableBase = Rx.ObservableBase,\n    AbstractObserver = Rx.internals.AbstractObserver,\n    observerCreate = Rx.Observer.create,\n    observableCreate = Rx.Observable.create,\n    disposableCreate = Rx.Disposable.create,\n    Disposable = Rx.Disposable,\n    CompositeDisposable = Rx.CompositeDisposable,\n    BinaryDisposable = Rx.BinaryDisposable,\n    SingleAssignmentDisposable = Rx.SingleAssignmentDisposable,\n    Subject = Rx.Subject,\n    Scheduler = Rx.Scheduler,\n    dom = Rx.DOM = {},\n    hasOwnProperty = {}.hasOwnProperty,\n    noop = Rx.helpers.noop,\n    isFunction = Rx.helpers.isFunction,\n    inherits = Rx.internals.inherits;\n\n  var errorObj = {e: {}};\n\n  function tryCatcherGen(tryCatchTarget) {\n    return function tryCatcher() {\n      try {\n        return tryCatchTarget.apply(this, arguments);\n      } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n      }\n    };\n  }\n\n  function tryCatch(fn) {\n    if (!isFunction(fn)) { throw new TypeError('fn must be a function'); }\n    return tryCatcherGen(fn);\n  }\n\n  function thrower(e) {\n    throw e;\n  }\n\n  function socketClose(socket, closingObserver, code, reason) {\n    if (socket) {\n      if (closingObserver) {\n        closingObserver.onNext();\n        closingObserver.onCompleted();\n      }\n      if (!code) {\n        socket.close();\n      } else {\n        socket.close(code, reason);\n      }\n    }\n  }\n\n  var SocketObservable = (function (__super__) {\n    inherits(SocketObservable, __super__);\n    function SocketObservable(state, url, protocol, open, close) {\n      this._state = state;\n      this._url = url;\n      this._protocol = protocol;\n      this._open = open;\n      this._close = close;\n      __super__.call(this);\n    }\n\n    function createOpenHandler(open, socket) {\n      return function openHandler(e) {\n        open.onNext(e);\n        open.onCompleted();\n        socket.removeEventListener('open', openHandler, false);\n      };\n    }\n    function createMsgHandler(o) { return function msgHandler(e) { o.onNext(e); }; }\n    function createErrHandler(o) { return function errHandler(e) { o.onError(e); }; }\n    function createCloseHandler(o) {\n      return function closeHandler(e) {\n        if (e.code !== 1000 || !e.wasClean) { return o.onError(e); }\n        o.onCompleted();\n      };\n    }\n\n    function SocketDisposable(socket, msgFn, errFn, closeFn, close) {\n      this._socket = socket;\n      this._msgFn = msgFn;\n      this._errFn = errFn;\n      this._closeFn = closeFn;\n      this._close = close;\n      this.isDisposed = false;\n    }\n\n    SocketDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        socketClose(this._socket, this._close);\n\n        this._socket.removeEventListener('message', this._msgFn, false);\n        this._socket.removeEventListener('error', this._errFn, false);\n        this._socket.removeEventListener('close', this._closeFn, false);\n      }\n    };\n\n    SocketObservable.prototype.subscribeCore = function (o) {\n      this._state.socket = this._protocol ? new WebSocket(this._url, this._protocol) : new WebSocket(this._url);\n\n      var openHandler = createOpenHandler(this._open, this._state.socket);\n      var msgHandler = createMsgHandler(o);\n      var errHandler = createErrHandler(o);\n      var closeHandler = createCloseHandler(o);\n\n      this._open && this._state.socket.addEventListener('open', openHandler, false);\n      this._state.socket.addEventListener('message', msgHandler, false);\n      this._state.socket.addEventListener('error', errHandler, false);\n      this._state.socket.addEventListener('close', closeHandler, false);\n\n      return new SocketDisposable(this._state.socket, msgHandler, errHandler, closeHandler, this._close);\n    };\n\n    return SocketObservable;\n  }(ObservableBase));\n\n  var SocketObserver = (function (__super__) {\n    inherits(SocketObserver, __super__);\n    function SocketObserver(state, close) {\n      this._state = state;\n      this._close = close;\n      __super__.call(this);\n    }\n\n    SocketObserver.prototype.next = function (x) {\n      this._state.socket && this._state.socket.readyState === WebSocket.OPEN && this._state.socket.send(x);\n    };\n\n    SocketObserver.prototype.error = function (e) {\n      if (!e.code) {\n        throw new Error('no code specified. be sure to pass { code: ###, reason: \"\" } to onError()');\n      }\n      socketClose(this._state.socket, this._close, e.code, e.reason || '');\n    };\n\n    SocketObserver.prototype.completed = function () {\n      socketClose(this._state.socket, this._close, 1000, '');\n    };\n\n    return SocketObserver;\n  }(AbstractObserver));\n\n   /**\n   * Creates a WebSocket Subject with a given URL, protocol and an optional observer for the open event.\n   *\n   * @example\n   *  var socket = Rx.DOM.fromWebSocket('http://localhost:8080', 'stock-protocol', openObserver, closingObserver);\n   *\n   * @param {String} url The URL of the WebSocket.\n   * @param {String} protocol The protocol of the WebSocket.\n   * @param {Observer} [openObserver] An optional Observer to capture the open event.\n   * @param {Observer} [closingObserver] An optional Observer to capture the moment before the underlying socket is closed.\n   * @returns {Subject} An observable sequence wrapping a WebSocket.\n   */\n  dom.fromWebSocket = function (url, protocol, openObserver, closingObserver) {\n    if (!WebSocket) { throw new TypeError('WebSocket not implemented in your runtime.'); }\n    var state = { socket: null };\n    return Subject.create(\n      new SocketObserver(state, closingObserver),\n      new SocketObservable(state, url, protocol, openObserver, closingObserver)\n    );\n  };\n\n  var WorkerObserver = (function (__super__) {\n    inherits(WorkerObserver, __super__);\n    function WorkerObserver(state) {\n      this._state = state;\n      __super__.call(this);\n    }\n\n    WorkerObserver.prototype.next = function (x) { this._state.worker && this._state.worker.postMessage(x); };\n    WorkerObserver.prototype.error = function (e) { throw e; };\n    WorkerObserver.prototype.completed = function () { };\n\n    return WorkerObserver;\n  }(AbstractObserver));\n\n  var WorkerObservable = (function (__super__) {\n    inherits(WorkerObservable, __super__);\n    function WorkerObservable(state, url) {\n      this._state = state;\n      this._url = url;\n      __super__.call(this);\n    }\n\n    function createMessageHandler(o) { return function messageHandler (e) { o.onNext(e); }; }\n    function createErrHandler(o) { return function errHandler(e) { o.onError(e); }; }\n\n    function WorkerDisposable(w, msgFn, errFn) {\n      this._w = w;\n      this._msgFn = msgFn;\n      this._errFn = errFn;\n      this.isDisposed = false;\n    }\n\n    WorkerDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        this._w.terminate();\n        this._w.removeEventListener('message', this._msgFn, false);\n        this._w.removeEventListener('error', this._errFn, false);\n      }\n    };\n\n    WorkerObservable.prototype.subscribeCore = function (o) {\n      this._state.worker = new root.Worker(this._url);\n\n      var messageHandler = createMessageHandler(o);\n      var errHandler = createErrHandler(o);\n\n      this._state.worker.addEventListener('message', messageHandler, false);\n      this._state.worker.addEventListener('error', errHandler, false);\n\n      return new WorkerDisposable(this._state.worker, messageHandler, errHandler);\n    };\n\n    return WorkerObservable;\n  }(ObservableBase));\n\n  /**\n   * Creates a Web Worker with a given URL as a Subject.\n   *\n   * @example\n   * var worker = Rx.DOM.fromWebWorker('worker.js');\n   *\n   * @param {String} url The URL of the Web Worker.\n   * @returns {Subject} A Subject wrapping the Web Worker.\n   */\n  dom.fromWorker = function (url) {\n    if (!root.Worker) { throw new TypeError('Worker not implemented in your runtime.'); }\n    var state = { worker: null };\n    return Subject.create(new WorkerObserver(state), new WorkerObservable(state, url));\n  };\n\n  function getMutationObserver(next) {\n    var M = root.MutationObserver || root.WebKitMutationObserver;\n    return new M(next);\n  }\n\n  var MutationObserverObservable = (function (__super__) {\n    inherits(MutationObserverObservable, __super__);\n    function MutationObserverObservable(target, options) {\n      this._target = target;\n      this._options = options;\n      __super__.call(this);\n    }\n\n    function InnerDisposable(mutationObserver) {\n      this._m = mutationObserver;\n      this.isDisposed = false;\n    }\n\n    InnerDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        this._m.disconnect();\n      }\n    };\n\n    MutationObserverObservable.prototype.subscribeCore = function (o) {\n      var mutationObserver = getMutationObserver(function (e) { o.onNext(e); });\n      mutationObserver.observe(this._target, this._options);\n      return new InnerDisposable(mutationObserver);\n    };\n\n    return MutationObserverObservable;\n  }(ObservableBase));\n\n  /**\n   * Creates an observable sequence from a Mutation Observer.\n   * MutationObserver provides developers a way to react to changes in a DOM.\n   * @example\n   *  Rx.DOM.fromMutationObserver(document.getElementById('foo'), { attributes: true, childList: true, characterData: true });\n   *\n   * @param {Object} target The Node on which to obserave DOM mutations.\n   * @param {Object} options A MutationObserverInit object, specifies which DOM mutations should be reported.\n   * @returns {Observable} An observable sequence which contains mutations on the given DOM target.\n   */\n  dom.fromMutationObserver = function (target, options) {\n    if (!(root.MutationObserver || root.WebKitMutationObserver)) { throw new TypeError('MutationObserver not implemented in your runtime.'); }\n    return new MutationObserverObservable(target, options);\n  };\n\n  var CurrentPositionObservable = (function (__super__) {\n    inherits(CurrentPositionObservable, __super__);\n    function CurrentPositionObservable(opts) {\n      this._opts = opts;\n      __super__.call(this);\n    }\n\n    CurrentPositionObservable.prototype.subscribeCore = function (o) {\n      root.navigator.geolocation.getCurrentPosition(\n        function (data) {\n          o.onNext(data);\n          o.onCompleted();\n        },\n        function (e) { o.onError(e); },\n        this._opts);\n    };\n\n    return CurrentPositionObservable;\n  }(ObservableBase));\n\n  var WatchPositionObservable = (function (__super__) {\n    inherits(WatchPositionObservable, __super__);\n    function WatchPositionObservable(opts) {\n      this._opts = opts;\n      __super__.call(this);\n    }\n\n    function WatchPositionDisposable(id) {\n      this._id = id;\n      this.isDisposed = false;\n    }\n\n    WatchPositionDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        root.navigator.geolocation.clearWatch(this._id);\n      }\n    };\n\n    WatchPositionObservable.prototype.subscribeCore = function (o) {\n      var watchId = root.navigator.geolocation.watchPosition(\n        function (x) { o.onNext(x); },\n        function (e) { o.onError(e); },\n        this._opts);\n\n      return new WatchPositionDisposable(watchId);\n    };\n\n    return WatchPositionObservable;\n  }(ObservableBase));\n\n  Rx.DOM.geolocation = {\n    /**\n    * Obtains the geographic position, in terms of latitude and longitude coordinates, of the device.\n    * @param {Object} [geolocationOptions] An object literal to specify one or more of the following attributes and desired values:\n    *   - enableHighAccuracy: Specify true to obtain the most accurate position possible, or false to optimize in favor of performance and power consumption.\n    *   - timeout: An Integer value that indicates the time, in milliseconds, allowed for obtaining the position.\n    *              If timeout is Infinity, (the default value) the location request will not time out.\n    *              If timeout is zero (0) or negative, the results depend on the behavior of the location provider.\n    *   - maximumAge: An Integer value indicating the maximum age, in milliseconds, of cached position information.\n    *                 If maximumAge is non-zero, and a cached position that is no older than maximumAge is available, the cached position is used instead of obtaining an updated location.\n    *                 If maximumAge is zero (0), watchPosition always tries to obtain an updated position, even if a cached position is already available.\n    *                 If maximumAge is Infinity, any cached position is used, regardless of its age, and watchPosition only tries to obtain an updated position if no cached position data exists.\n    * @returns {Observable} An observable sequence with the geographical location of the device running the client.\n    */\n    getCurrentPosition: function (geolocationOptions) {\n      if (!root.navigator && !root.navigation.geolocation) { throw new TypeError('geolocation not available'); }\n      return new CurrentPositionObservable(geolocationOptions);\n    },\n\n    /**\n    * Begins listening for updates to the current geographical location of the device running the client.\n    * @param {Object} [geolocationOptions] An object literal to specify one or more of the following attributes and desired values:\n    *   - enableHighAccuracy: Specify true to obtain the most accurate position possible, or false to optimize in favor of performance and power consumption.\n    *   - timeout: An Integer value that indicates the time, in milliseconds, allowed for obtaining the position.\n    *              If timeout is Infinity, (the default value) the location request will not time out.\n    *              If timeout is zero (0) or negative, the results depend on the behavior of the location provider.\n    *   - maximumAge: An Integer value indicating the maximum age, in milliseconds, of cached position information.\n    *                 If maximumAge is non-zero, and a cached position that is no older than maximumAge is available, the cached position is used instead of obtaining an updated location.\n    *                 If maximumAge is zero (0), watchPosition always tries to obtain an updated position, even if a cached position is already available.\n    *                 If maximumAge is Infinity, any cached position is used, regardless of its age, and watchPosition only tries to obtain an updated position if no cached position data exists.\n    * @returns {Observable} An observable sequence with the current geographical location of the device running the client.\n    */\n    watchPosition: function (geolocationOptions) {\n      if (!root.navigator && !root.navigation.geolocation) { throw new TypeError('geolocation not available'); }\n      return new WatchPositionObservable(geolocationOptions).publish().refCount();\n    }\n  };\n\n  var FromReaderObservable = (function (__super__) {\n    inherits(FromReaderObservable, __super__);\n    function FromReaderObservable(readerFn, file, progressObserver, encoding) {\n      this._readerFn  = readerFn;\n      this._file = file;\n      this._progressObserver = progressObserver;\n      this._encoding = encoding;\n      __super__.call(this);\n    }\n\n    function createLoadHandler(o, p) {\n      return function loadHandler(e) {\n        p && p.onCompleted();\n        o.onNext(e.target.result);\n        o.onCompleted();\n      };\n    }\n\n    function createErrorHandler(o) { return function errorHandler (e) { o.onError(e.target.error); }; }\n    function createProgressHandler(o) { return function progressHandler (e) { o.onNext(e); }; }\n\n    function FromReaderDisposable(reader, progressObserver, loadHandler, errorHandler, progressHandler) {\n      this._r = reader;\n      this._po = progressObserver;\n      this._lFn = loadHandler;\n      this._eFn = errorHandler;\n      this._pFn = progressHandler;\n      this.isDisposed = false;\n    }\n\n    FromReaderDisposable.prototype.dispose = function () {\n      if (!this.isDisposed) {\n        this.isDisposed = true;\n        this._r.readyState === root.FileReader.LOADING && this._r.abort();\n        this._r.removeEventListener('load', this._lFn, false);\n        this._r.removeEventListener('error', this._eFn, false);\n        this._po && this._r.removeEventListener('progress', this._pFn, false);\n      }\n    };\n\n    FromReaderObservable.prototype.subscribeCore = function (o) {\n      var reader = new root.FileReader();\n\n      var loadHandler = createLoadHandler(o, this._progressObserver);\n      var errorHandler = createErrorHandler(o);\n      var progressHandler = createProgressHandler(this._progressObserver);\n\n      reader.addEventListener('load', loadHandler, false);\n      reader.addEventListener('error', errorHandler, false);\n      this._progressObserver && reader.addEventListener('progress', progressHandler, false);\n\n      reader[this._readerFn](this._file, this._encoding);\n\n      return new FromReaderDisposable(reader, this._progressObserver, loadHandler, errorHandler, progressHandler);\n    };\n\n    return FromReaderObservable;\n  }(ObservableBase));\n\n  /**\n   * The FileReader object lets web applications asynchronously read the contents of\n   * files (or raw data buffers) stored on the user's computer, using File or Blob objects\n   * to specify the file or data to read as an observable sequence.\n   * @param {String} file The file to read.\n   * @param {Observer} An observer to watch for progress.\n   * @returns {Object} An object which contains methods for reading the data.\n   */\n  dom.fromReader = function(file, progressObserver) {\n    if (!root.FileReader) { throw new TypeError('FileReader not implemented in your runtime.'); }\n\n    return {\n      /**\n       * This method is used to read the file as an ArrayBuffer as an Observable stream.\n       * @returns {Observable} An observable stream of an ArrayBuffer\n       */\n      asArrayBuffer : function() {\n        return new FromReaderObservable('readAsArrayBuffer', file, progressObserver);\n      },\n      /**\n       * This method is used to read the file as a binary data string as an Observable stream.\n       * @returns {Observable} An observable stream of a binary data string.\n       */\n      asBinaryString : function() {\n        return new FromReaderObservable('readAsBinaryString', file, progressObserver);\n      },\n      /**\n       * This method is used to read the file as a URL of the file's data as an Observable stream.\n       * @returns {Observable} An observable stream of a URL representing the file's data.\n       */\n      asDataURL : function() {\n        return new FromReaderObservable('readAsDataURL', file, progressObserver);\n      },\n      /**\n       * This method is used to read the file as a string as an Observable stream.\n       * @returns {Observable} An observable stream of the string contents of the file.\n       */\n      asText : function(encoding) {\n        return new FromReaderObservable('readAsText', file, progressObserver, encoding);\n      }\n    };\n  };\n\n  return Rx;\n}));"]},"metadata":{},"sourceType":"script"}